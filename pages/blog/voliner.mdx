---
title: 'Voliner - Flywheel energy storage system'
publishedAt: '2020-10-21'
summary: Development and implementation of an inertia flywheel-based energy storage system with applications in a smart power grid
image: '/static/images/voliner/complete-render.png'
---

![SolidWorks model render](/static/images/voliner/complete-render-700.png)

**Welcome!** This is my first blog post and I've found it to be the perfect
opportunity to share my _final year university project_.
**Voliner** is a name that came up by joining the Spanish words
_"Volante"_ (_flywheel_) and _"Inercia"_ (_inertia_). This project consists of
the **Development and implementation of an inertia
flywheel-based energy storage system with applications in a smart power grid**.
_I hope you like it!_

### Project scope:

- Creation of a full flywheel energy storage system
- Design of the mechanical assembly
- Construction of a 3-phase AC-DC bidirectional electronic converter
- Implementation of software for the control system and bidirectional AC-DC conversion
- Development of a control strategy to stabilize voltage fluctuations
- Integration of active voltage regulation, start-up, shutdown and emergency subsystems
- Creation of a GUI with osciloscope-like plots and PID tuning tools
- Design and implementation of a commisioning rutine

## Motivation

The distributed location and intermittency of renewable energy sources (day
and seasonal cycles, climatic and meteorological dependencies) require reformulating
three classic characteristics of interconnected systems:

- Unidirectionality of the power flow (from generation centers to consumers)
- Centralization of their management
- Generation based only on-demand requirements

**In order not to waste the available renewable energy,
excess generation must be injected into the system and/or stored until
required**, which requires multidirectional flow of power and
decentralized management, located in each network and planned according
to predictions of production and energy consumption.
This **requires real-time control systems to compensate for discrepancies** between
these forecasts and their actual manifestations. The concept of **Smart Grid** is a
potential way to address these challenges.

> ### Smart Grid
>
> - Power Grid equipped with a digital layer.
> - Allows planned management and real-time control of the generation, storage and consumption of energy.
> - Multidirectional flow of power inside the network.
> - Bidirectional flow of power in its interaction with the global power system.

## Summary

The work carried out is part of a project to expand the university's
intelligent micro-grid, which aims to obtain hybrid energy storage
for it. The energy storage solution designed has **three main components**:

- A **flywheel** (mechanical device to store kinetic energy)
- A three-phase **induction machine**
- A two-way **AC-DC electronic converter**

Its function is to **stabilize the DC bus voltage
of the network**, suppressing both the medium frequency and high frequency components of
the currents circulating through the battery bank, protecting the batteries
health and improving the overall operation of the network.

> We’ll use the term **induction machine** and not induction motor
> because it operates as a **motor** (storing energy)
> or as a **generator** (returning stored energy) depending on circumstances.

The converter's control
strategies are implemented in a Texas Instruments F28335 DSP, programmed
in C language.

![Texas Instruments F28335 DSP](/static/images/voliner/tmdscncd28335_control_card-700.jpg)

## Introduction

To increase the reliability and quality of the energy resource in a smart grid
energy storage is needed. The devices to achieve it can be divided in
the following categories.

- **Conventional:** battery banks, capacitors
- **Unconventional:** reversible hydroelectric plants, hydrogen-based energy storage systems
  or systems based on **flywheels**.

Prior to the realization of
this project, the smart grid of the _Automation and Control Laboratory_
(LAC) had a single energy storage system, which is a bank of
lead-acid batteries. Due to its nature, its main disadvantage is the
_early degradation_ that it suffers when subjected to micro cycles of
charging and discharging and / or iterated current peaks.

To address
this problem, we introduced of a second energy store, based on
_Flywheel Energy Storage System_ (FESS), thus obtaining **hybrid
energy storage**. This allows a separation, based on frequency,
of the current of the storage devices:

- Low frequency <-> battery bank
- Medium frequency <-> FESS
- High frequency <-> capacitors in the DC bus.

> Since the whole system is connected by a DC bus, we can assoiate
> currents with power (_P=IxV_ where _V_ is constant)

The following figure shows a **graphical representation of the resulting
hybrid energy storage system**, which is also the base _system model_ used to
create the control strategy:

![Grid model](/static/images/voliner/introduction.svg)

Hybrid energy storage resulting from the combination of a battery bank
and a FESS is a solution that combines the _best of both worlds!_

import ProsCard from '../../components/ProsCard';
import ConsCard from '../../components/ConsCard';

<ProsCard
  title="Advantages of Flywheel Energy Storage Systems"
  pros={[
    `Can withstand a very high number of charges and discharges without degrading.`,
    `Can deliver high-value current peaks (High power capacity).`
  ]}
/>

<ConsCard
  title="Disadvantages of Flywheel Energy Storage Systems"
  cons={[
    `Has a high self-discharge (mainly due to friction losses).`,
    `Has a relatively low energy capacity.`
  ]}
/>

**All cons are covered by combining it with batteries!. They have
a low self-discharge rate and a high energy capacity**

The characteristics of both storage devices complement
each other. **The presence of the FESS and capacitors allow both the
voltage of the DC bus and the battery current to evolve smoothly
towards a new regime value**, not only **increasing battery life** but also
**improving the overall operation of the smart grid**.

> If the duration of the
> disturbance is short enough, all energy is delivered or received by
> the FESS and both the _DC bus_ and the current of the batteries remain
> unchanged.

## Description of the Flywheel Energy Storage System

An inertia flywheel-based energy storage system (FESS) consists of the
use of a _rotating_ element to store **kinetic energy**. This element is
coupled with the shaft of an _electrical machine_ that works as a
transformer between the _electrical_ and _mechanical_ domains. The electrical
machine can work as a _generator_ or a _motor_ in the following situations:

- **Motor:** Increase its _kinetic energy_ by accelerating the rotating element
  taking _electric energy_ from the grid.
- **Generator:** Decrease its _kinetic energy_ by slowing down the rotating element
  delivering _electric energy_ from the grid.

Normally the speeds at which the high axis rotates are high (20000-50000 rpm)
in order to store as much energy as possible,
since the rotating kinetic energy is proportional to the square of the
turning speed. In addition, to decrease friction losses the rotating
element is usually placed in a vacuum chamber, with the shaft upright
and levitating magnetically. **This development consists of small-scale
FESS construction and control, for teaching and experimental purposes**,
so it will not have the latter and the rotational speed it’s going to
be lower. While its characteristics and dimensions are not the same as
that of a FESS for higher power applications, **it's a device that serves
well to research both energy management strategies and induction
machine control**.

![Flywheel covered](/static/images/voliner/flywheel_covered-700.jpg)

![Flywheel uncovered](/static/images/voliner/flywheel_uncovered-700.jpg)

## Electronic Converter

The designed system consists of a _0.6kgmss_ _flywheel_ coupled to a
_1.1KW_ _three-phase induction machine_ and a _2KVA_ _AC-DC bidirectional
converter_.

**The converter can operate as a _three-phase inverter_ or
_three-phase rectifier_**. It is based on the integrated circuit
_Mitsubishi PS21A79_ that encapsulates
the _three-phase IGBTs bridge_
with their respective drivers and protections, and _Texas Instruments
F28335 DSP_ where control strategies are implemented.

![Converter front](/static/images/voliner/converter_front-700.jpg)

![Converter back](/static/images/voliner/converter_back-700.jpg)

## Control Strategy

**The control strategy implemented is an adaptation of**
[An Innovative Control Strategy of a Single Converter for Hybrid Fuel Cell/Supercapacitor Power Source](https://ieeexplore.ieee.org/document/5422652).
That proposes a way to decouple currents in the frequency domain for a _Fuel
cell_ and a _bank of supercapacitors_. For this variant **instead of the _fuel cell_ a _battery bank_
is used and the place of the _supercapacitor bank_
is occupied by the _flywheel_**
(and the capacitors in the DC bus).

Let's see a simplified schema of the implemented control
topology, which is reduced to a number of nested PID controllers.

![Grid model](/static/images/voliner/control_scheme.svg)

- At the **inner level** we can see the regulators that control the induction
  machine's **currents in the dq frame**, i.e. isd and isq.
- The setpoint of the **isd** current is set to such a value that it generates
  the desired **magnetization level** for the machine.
- the **isq** current setpoint can be generated by two different
  controllers **depending on the operating mode** in which the system is located.
  - During **normal operation** the isq reference is generated
    by the **voltage regulator** so that if, for example,
    if you want to increase the voltage of the DC bus
    you get power at the wheel by applying a negative torque (or a negative
    quadrature current).
  - For **complementary system operation** (start up, shutdown
    and limitations) the isq setpoint is generated by the **speed control**
    controller.
- The **voltage regulator** reference is driven by the
  **recovery regulator**, responsible for
  - Keeping the flywheel
    spinning at a certain speed when the system is in stand by
  - Restoring that speed after an event in which the system delivers
    or absorbs energy.

> The **speed reference** is adjustable and should be chosen based on a
> _trade-off_, since represents the
> amount of energy that the system has stored and ready to deliver,
> but it also conditions the amount of energy that the system
> can absorb (due to the mechanical and electrical limitations
> of the machine).

## Experimental results

**Steps and pulses** of 4A load current were performed using a _resistor bank_
to _verify the correct operation_ of the designed FESS.
The results obtained in each test are compacted into a figure that shows:

- Components of the **stator current in the dq frame** with their respective
  _setpoints_.
- **DC-side currents of the converter**, particularly the current by the
  _battery_ (ibat), the current by the _charge_ (iload), and the current
  delivered/absorbed by the _converter_ (i_FW).
- **DC bus voltage** (Vdc), its _setpoint_ (VdcRefb) and _voltage
  evolution with FESS disabled_ (natural). It should be noted
  that this last curve arises from a second test and not from a simulation or
  estimation.
- Rotation **speed of the flywheel** and its stand by speed (natural).

### Step test

We begin by analyzing the **system response to a 4A load step**.

1. When the step occurs the system _reacts_ by producing a negative flank
   of current isq while the current isd remains constant.
2. The evolution
   of isq is reflected in iFW which implies that the charging current
   flank is delivered by the FESS and not by the batteries.
3. The currents isq and iFW then evolve smoothly towards their resting value.
4. The iFW current flank and its slow extinction results in a smooth
   evolution of the battery current and voltage of the DC bus towards
   its new regime values.
   It's observed that **the voltage evolution is
   much smoother than when the FESS is disabled** (natural).

![Step response](/static/images/voliner/step_response.svg)

### Pulse test

Let's analyze now the **system response to a 4A load pulse of
300ms duration**. The FESS does not completely eliminate the
disturbance, but **reduces the amplitude of battery current
and DC bus voltage variations by approximately 75%**.

![Pulse response](/static/images/voliner/pulse_response.svg)

## Conclusions

- The built system proved to have a **remarkable structural robustness**
  without the need to add external bearings, thus managing to maintain the
  levels of _energy loss_ by friction at _relatively low_ values.
- The **use of a _field oriented control_** (FOC) played an important role
  in the control of the _induction machine_.
  While it is often used to control speed or torque, it turned
  out to be _versatile and robust_ enough to **control the _power flow_**
  between the FESS and the smart grid.
- With regard to the operation of the **FESS as part of a smart grid**,
  the _hybridization of the energy storage_ achieved by introducing a second
  storage device significantly _reduced the presence of medium and high
  frequency components in the current_ circulating through the _battery bank_
  and in the _voltage of the DC bus_. As a result, when there are abrupt
  changes in the smart grid load, these variables evolve smoothly towards
  their new regime value, **improving battery life and overall operation of
  the smart grid**.
- The **FESS has a limitation in its _system response time_**.
  It cannot act fully in the first milliseconds after a disturbance. The
  response time is formed by the combination of the _electrical constant of
  the induction machine currents_ found in the most internal control
  loop and by the _control structure itself_. **Adding capacitors is an effective
  way to compensate this**.

  > The voltage disturbance
  > compensation time is between 5 and 10 times longer than the current
  > control response time because disturbance compensation is performed in a
  > loop outside the current control loop in a _cascading control_ scheme.
  > Having a
  > smaller ratio would cause _oscillations due to interference_ between control
  > loops and even _instability_.

- The broad **DC bus voltage range** (240V-300V) introduced an additional
  degree of _complexity_ the system _dynamics_ depends on the voltage
  value. As a result, _PID regulators_ had to be adapted to
  perform properly across the smart grid _operating range_. The variation
  of this voltage also conditions the ability of the isd and isq current
  regulators to act, which results in a _limitation in the
  system power capacity_ (remember that P=VxI).
- The _self-discharge_ of the constructed FESS is much _greater_ than that
  of its _commercial equivalents_ because those have several constructive
  advantages, the main ones being _magnetic levitation_ (which significantly
  reduces the losses present in the motor shaft bearings) and the _vacuum
  environment_ (which eliminates friction with air). This difference _doesn’t
  have a significant impact in the system dynamics_,
  so the **results obtained are valid
  and scalable to commercial FESS**. However, this has an impact on the
  energy consumption needed to keep the flywheel spinning at stand-by
  speed.
